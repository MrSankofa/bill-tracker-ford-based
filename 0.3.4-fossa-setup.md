### 0.3.4 Overview


Goal: Automatically scan dependencies (licenses + known risks) on every PR / push, and upload results to FOSSA.

* FOSSA CLI v3
* a push-only token
* github actions now, and later we can translate the exact same steps to Tekton


## 0.3.4.1 Set up your FOSSA account and organization

### Step 1: Sign in and confirm you’re in the right place

1. Open FOSSA in your browser and sign in  
   (usually via GitHub / Google / email depending on your org setup)

2. Once signed in, look for:
    - Your avatar or email in the top right
    - Any **Organization** selector  
      (some tools show a dropdown if you belong to multiple orgs)

#### What you’re verifying

- You can actually reach the web app.
- You’re not stuck in a marketing page or a “pending invite” state.

#### Checkpoint test

- You can see a dashboard or main app navigation, not just docs/marketing.

---

### Step 2: Find “Organization Settings”

FOSSA docs describe creating tokens from **Organization Settings** and managing
users / teams / roles there.  
*(FOSSA Guides)*

#### Do this

1. Click your avatar/email (top right).
2. Choose something like:
    - **Settings**
    - **Organization Settings**
    - **Account Settings** (wording varies)

If you see multiple tabs/sections, look for:
- **Integrations**
- **Users**
- **Teams**
- **Roles**

Those are standard areas described in their docs.  
*(FOSSA Guides)*

---

#### Checkpoint test

- You can reach a page that clearly says **Organization Settings**
  (or equivalent) and shows settings categories like
  Users / Teams / Integrations.


### Step 3: Confirm (or create) your organization

Now we need to ensure you have the correct org context because later your scans
will land in that org.

#### If you already see an organization name

- Click into it and confirm it is the org you want for this project  
  (for personal projects it might be your name, for work it might be your company).
- If you belong to multiple orgs, switch to the one you want.

#### If you are prompted to create one

Create an org with:

- **Name**: something like `Sankofa` or `Altruistic Software Development`
- **Slug/key**: keep it short and stable  
  (this matters later for integrations)

#### Checkpoint test

- You can clearly see the organization name somewhere in the UI and you can
  navigate within it.

---

### Step 4: Confirm you have permission to create tokens

We need to make sure you can create API tokens later.  
FOSSA docs say tokens are created under  
**Organization Settings → Integrations → API (or API User)**, and tokens are shown
only once.  
*(FOSSA Guides)*

#### Do this

1. In **Organization Settings**, go to **Integrations**
2. Look for **API** or **API Tokens**

If you can see the API token page (even if you do not create one yet), you have
the permission level needed.

#### Checkpoint test

- You can navigate to an **API / API Tokens** section  
  (do **not** generate a token yet in 0.3.4.1).

---

### Step 5: Optional but recommended setup checks
*(avoid pain later)*

These reduce friction in later steps.

---

#### 5A) Confirm user email and profile

- Confirm the account email is correct and accessible.
- This prevents issues where GitHub Actions runs but you cannot access scans due
  to org membership mismatch.

---

#### 5B) Confirm GitHub integration option exists
*(do not configure yet)*

FOSSA supports GitHub integration via OAuth or GitHub App.  
*(FOSSA Guides)*

We are not doing this yet, but verify you can find **GitHub** in integrations later.

#### Checkpoint test

- You can find an integrations list that includes **GitHub**
  (or indicates GitHub can be connected).


### Final Alignment Test

1. ***Do you see "Organization Settings (or equivalent)" and you can open it?***
2. ***What is the organization name you see selected right now?***
3. ***Can you navigate to the integrations and see an API/API Tokens section?***

## 0.3.4.2 Create a FOSSA API token for CI (Push-Only)

### Why we’re doing this

Your CI pipeline needs a credential so it can **upload scan results to FOSSA**.
That credential should be:

- **Non-human**  
  (so it doesn’t break when a user leaves)
- **Least privilege**  
  (so if it leaks, damage is limited)
- **Easy to rotate**  
  (you can replace it without touching code)

FOSSA supports token-based auth for the CLI and recommends using tokens that are
appropriate for automation (**push-only where possible**).

---

### Step-by-step (click path)

---

### Step 1: Go to the API tokens page

You said you can already reach it, so do:

- **Organization Settings**
    - **Integrations**
        - **API** or **API Tokens**

*(Exact label varies, but you’re there.)*

---

### Step 2: Create a new token

Click something like:

- **Create token**
- **Generate token**
- **Add API key**

---

### Step 3: Name it like a CI credential

Use a name that tells you:

- what repo it’s for
- what it’s used for
- where it runs

#### Example name

- `bill-tracker-ford-based-github-actions`

If you plan to also run scans in Tekton later, you can create a second token later:

- `bill-tracker-ford-based-tekton`

---

### Step 4: Choose the safest permission level

If FOSSA offers a choice like:

- Push-only
- Full access
- Read/write

**Choose push-only.**

If FOSSA doesn't show a "push-only" option, choose the least privilege option.

### Step 5: Create and copy the token (one-time view)

When you generate the token, **copy it immediately**. You will not be able to see it again.
save it in a password manager or secure notes app.



## 0.3.4.3 Add the FOSSA token to GitHub Secrets

### What this step does (why it exists)

Your CI pipeline runs in **GitHub Actions**, not on your laptop.

So:

- The FOSSA CLI needs a token
- The token must be available **only at runtime**
- The token must **never live in the repo**

GitHub Secrets are the correct mechanism for this.  
This is the same pattern you already used successfully for **SonarCloud**.

---

### Step-by-step (no guessing)

---

### Step 1: Open your repository settings

In GitHub:

1. Go to your repository: `bill-tracker-ford-based`
2. Click **Settings**
3. In the left sidebar, click:
    - **Secrets and variables**
    - **Actions**

You should now see sections for:

- **Repository secrets**
- **Environment secrets** (ignore those for now)

---

### Step 2: Create the secret

1. Click **New repository secret**
2. Fill in exactly:
    - **Name**: `FOSSA_API_KEY`
    - **Value**: paste the token you just created in FOSSA
3. Click **Save**

---

### Important

- The name must be **exactly** `FOSSA_API_KEY`
- Case-sensitive
- No extra spaces

The FOSSA CLI automatically looks for this environment variable name.
We are intentionally aligning with the default to avoid extra configuration.
This is straight from FOSSA’s CLI behavior.


![img_1.png](img_1.png)

### 0.3.4.4 Fix your pipeline install step (v3 + no permission issues)

You already found the failure:

You were installing v1 (deprecated)

It tried to write to /usr/local/bin and got permission denied

FOSSA itself recommends using install-latest.sh to get the latest CLI (v3).
FOSSA - Guides & Documentation
+2
FOSSA - Guides & Documentation
+2

Update your GitHub Actions workflow

Replace your install step with:

```yaml
- name: Install FOSSA CLI (v3)
  run: |
    mkdir -p "$HOME/.local/bin"
    curl -H 'Cache-Control: no-cache' https://raw.githubusercontent.com/fossas/fossa-cli/master/install-latest.sh | bash -s -- -b "$HOME/.local/bin"
    echo "$HOME/.local/bin" >> $GITHUB_PATH
    fossa --version



```

Why this works:

Installs the current supported CLI (v3)
FOSSA - Guides & Documentation
+1

Installs to a user-writable directory to avoid /usr/local/bin permission issues

Adds it to PATH for later steps in the job

Checkpoint test

Run the workflow and confirm the log prints fossa --version.

### 0.3.4.5 Add the actual scan step (fossa analyze)

Once CLI installs, add this step:

```yaml
- name: FOSSA Analyze
  env:
    FOSSA_API_KEY: ${{ secrets.FOSSA_API_KEY }}
  run: |
    fossa analyze

```

FOSSA documents FOSSA_API_KEY=<token> fossa analyze as the standard CI invocation.
FOSSA - Guides & Documentation
+1

Monorepo note (important)

If your repo has backend/ and frontend/, you need to decide where to run fossa analyze:

If you want full repo scan (backend + frontend deps), run it from repo root

If you only want backend for now, run it from backend/

Strong opinion for your case: run it from repo root so you catch npm/pnpm deps later too.

So in YAML you can do:

```yaml
- name: FOSSA Analyze
  env:
    FOSSA_API_KEY: ${{ secrets.FOSSA_API_KEY }}
  run: |
    fossa analyze

```


(And do not set working-directory for that step, or set it explicitly to root.)

Checkpoint test

Actions should show:

Analyze completes

Results upload succeeds

### 0.3.4.6 Confirm results in FOSSA UI

Once upload succeeds:

Open FOSSA UI

Find your project

Confirm a scan exists for your default branch

Checkpoint test

